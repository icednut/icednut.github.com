{"data":{"site":{"siteMetadata":{"title":"Icednut's Notes","author":"Will Lee","siteUrl":"https://icednut.github.io"}},"markdownRemark":{"id":"26825211-0e30-5973-86f7-cb1d9d6fc92b","excerpt":"시작하기 전에..인터넷을 보면 Java로 Mediator 패턴을 구현 및 설명한 글들은 많이 있다. 그런데 왠지 체감이 되질 않아서 Vaadin을 이용하여 Todo Web Applicaiton을 만들면서 Mediator 패턴을 적용해보도록 하겠다. Vaadin…","html":"<h2>시작하기 전에..</h2>\n<p>인터넷을 보면 Java로 Mediator 패턴을 구현 및 설명한 글들은 많이 있다. 그런데 왠지 체감이 되질 않아서 Vaadin을 이용하여 Todo Web Applicaiton을 만들면서 Mediator 패턴을 적용해보도록 하겠다. Vaadin이란 간단하게 말해서 Java만으로 웹 프론트엔드 코딩을 할 수 있게 해주는 프레임워크로써 Javascript 없이 Java 언어만 가지고도 Progressive Web App 홈페이지를 만들 수 있다. Vaadin에 대한 설명은 <a href=\"https://vaadin.com/\">https://vaadin.com/</a> 을 가면 알 수 있다.\n<br/>\n<br/></p>\n<h2>Plain Todo App</h2>\n<p>일단 디자인 패턴이 하나도 적용되어 있지 않은 Todo 앱을 만들어보겠다. 그냥 단순하게 Button, TextField, CheckBox 등을 한 클래스에서 직접 조합하여 만들었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">.\n├── Dockerfile\n├── LICENSE.md\n├── README.md\n├── frontend\n│   ├── src\n│   │   └── README\n│   └── styles\n│       └── README\n├── package-lock.json\n├── package.json\n├── pom.xml\n├── src\n│   ├── main\n│   │   ├── java\n│   │   │   └── space\n│   │   │       └── icednut\n│   │   │           └── dev\n│   │   │               └── vaadin\n│   │   │                   └── exercise\n│   │   │                       └── spring\n│   │   │                           ├── Application.java\n│   │   │                           └── MainView.java\n│   │   └── resources\n│   └── test\n│       └── java\n│           └── space\n│               └── icednut\n│                   └── dev\n│                       └── vaadin\n│                           └── exercise\n│                               └── spring\n│                                   ├── AbstractViewTest.java\n│                                   └── MainViewIT.java\n├── webpack.config.js\n└── webpack.generated.js</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">space<span class=\"token punctuation\">.</span>icednut<span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>exercise<span class=\"token punctuation\">.</span>spring</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>flow<span class=\"token punctuation\">.</span>component<span class=\"token punctuation\">.</span>button</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Button</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>flow<span class=\"token punctuation\">.</span>component<span class=\"token punctuation\">.</span>checkbox</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Checkbox</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>flow<span class=\"token punctuation\">.</span>component<span class=\"token punctuation\">.</span>icon</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Icon</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>flow<span class=\"token punctuation\">.</span>component<span class=\"token punctuation\">.</span>icon</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">VaadinIcon</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>flow<span class=\"token punctuation\">.</span>component<span class=\"token punctuation\">.</span>orderedlayout</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">HorizontalLayout</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>flow<span class=\"token punctuation\">.</span>component<span class=\"token punctuation\">.</span>orderedlayout</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">VerticalLayout</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>flow<span class=\"token punctuation\">.</span>component<span class=\"token punctuation\">.</span>textfield</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">TextField</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>flow<span class=\"token punctuation\">.</span>router</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Route</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>flow<span class=\"token punctuation\">.</span>server</span><span class=\"token punctuation\">.</span>PWA<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>util</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@Route</span>\n<span class=\"token annotation punctuation\">@PWA</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"Design Pattern Exercise\"</span><span class=\"token punctuation\">,</span> shortName <span class=\"token operator\">=</span> <span class=\"token string\">\"DPE\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MainView</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">VerticalLayout</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MainView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">final</span> <span class=\"token class-name\">VerticalLayout</span> todosList <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">VerticalLayout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// &lt;1></span>\n        <span class=\"token keyword\">final</span> <span class=\"token class-name\">TextField</span> todoField <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TextField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// &lt;2></span>\n        <span class=\"token keyword\">final</span> <span class=\"token class-name\">Button</span> addButton <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Button</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Add\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// &lt;2></span>\n\n        addButton<span class=\"token punctuation\">.</span><span class=\"token function\">addClickListener</span><span class=\"token punctuation\">(</span>event <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// &lt;3></span>\n            <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> todoValue <span class=\"token operator\">=</span> todoField<span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">hasText</span><span class=\"token punctuation\">(</span>todoValue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">final</span> <span class=\"token class-name\">Checkbox</span> checkbox <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Checkbox</span><span class=\"token punctuation\">(</span>todoValue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// &lt;4></span>\n                <span class=\"token keyword\">final</span> <span class=\"token class-name\">Icon</span> deleteButton <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Icon</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">VaadinIcon</span><span class=\"token punctuation\">.</span>CLOSE_CIRCLE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// &lt;4></span>\n                <span class=\"token keyword\">final</span> <span class=\"token class-name\">HorizontalLayout</span> todoElementLayout <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HorizontalLayout</span><span class=\"token punctuation\">(</span>checkbox<span class=\"token punctuation\">,</span> deleteButton<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// &lt;4></span>\n\n                deleteButton<span class=\"token punctuation\">.</span><span class=\"token function\">setSize</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"15px\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                deleteButton<span class=\"token punctuation\">.</span><span class=\"token function\">addClickListener</span><span class=\"token punctuation\">(</span>deleteEvent <span class=\"token operator\">-></span> todosList<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>todoElementLayout<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                todoElementLayout<span class=\"token punctuation\">.</span><span class=\"token function\">setAlignItems</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Alignment</span><span class=\"token punctuation\">.</span>CENTER<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                todosList<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>todoElementLayout<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// &lt;5></span>\n                todoField<span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>todosList<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HorizontalLayout</span><span class=\"token punctuation\">(</span>todoField<span class=\"token punctuation\">,</span> addButton<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// &lt;6></span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>하나의 클래스에 UI 구성 코드와 비즈니스 로직이 모두 들어있다. Vaadin에 익숙히지 않은 사람들을 위해 하나씩 설명하자면,</p>\n<ul>\n<li>&#x3C;1> : Todo 항목 컴포넌트 배치할 컨테이너 형식의 컴포넌트라고 보면 된다.</li>\n<li>&#x3C;2> : TextField, Button 인스턴스를 만들었다. 이는 Todo 메세지 입력과 Todo 추가 버튼의 역할을 하게 된다.</li>\n<li>&#x3C;3> : Todo 추가 버튼을 클릭하면 동작할 리스닝 핸들러 함수를 셋팅한다.</li>\n<li>&#x3C;4> : Todo 추가에 필요한 Todo 항목 컴포넌트를 구성하는 부분이다. Checkbox(Todo 항목), Icon(Todo 삭제 버튼) 인스턴스를 만들어서 HorizontalLayout으로 감쌌다. 이렇게 하면 화면에 Checkbox와 Icon을 가로로 늘어놓을 수 있다.</li>\n<li>&#x3C;5> : 4번 과정에서 생성한 Todo 항목 컴포넌트를 1번 과정에서 생성한 Todo 리스트 컴포넌트에 추가한다. 이렇게만 해도 화면에 Todo 항목이 추가되는 것을 볼 수 있다.</li>\n<li>&#x3C;6> : 메인뷰 컴포넌트에 TodoList와 Todo 입력 컴포넌트들을 배치한다.</li>\n</ul>\n<p>TextField, Button UI 구성한 뒤 버튼의 클릭 이벤트를 리스닝해서 Todo항목인 CheckBox와 DeleteButton을 화면에 추가하는 이 로직은 얼핏 보기에는 단순하면서 더 이상 손볼 필요도 없는 코드라고 생각할지도 모르겠다. 하지만 Todo 항목 추가, 삭제에 대한 행동을 Undo, Redo 할 수 있게 한다면? 또는 Todo 항목 수정에 대한 로직을 추가해야 된다고 한다면? 요구사항이 늘어날수록 MainView 클래스에 로직이 점점 늘어날 뿐만 아니라 비즈니스 로직도 MainView 클래스 하나에 모두 때려넣었기 때문에 유닛 테스트 코드 작성도 힘들어질 것이다.</p>\n<p>이럴 때 필요한게 역할과 책임으로 로직을 나누는 객체지향 프로그래밍 방식이 필요하다. 나는 개인적으로 UI 프로그래밍이 요구사항 변화가 빈번해서 객체지향 프로그래밍 적용이 수월하다고 생각한다. 요구사항 변화가 적은 영역이 어딘들 없겠느냐 하겠지만 UI 프로그래밍이 객체지향 프로그래밍 연습으로는 제격인 것 같다. 그래서 일부러 연습을 위해 Vaadin을 선택하기도 했다.</p>\n<p>위 코드를 실행하면 다음과 같은 화면을 볼 수 있다.\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/624f90eb79890ee5f1dbf72417b73538/079dc/01-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 63.56026785714285%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAABE0lEQVQ4y2OQkpGzVVHTnK1nZDpZSU1ziqS03BQRMUmisYSU3BQJabnJkjIKs4DsKoZp02eW7tl38P/W7Tv/79q9F0jv+L9123ai8e69+//v2rPv/5HjJ/+vXL3mMcPDJ89y/0PADyD+BcS/ycA/oWZcYrhy5WoeiPX12/c/377/+vf79+//f/78+f+bSAxV+wdkxqdPn64y3L59Kw9qOkjwH4jx79+//6QAoHqwgV+/fr3KcOsWwsB/EPCfVEPxGvifDDB0Dfz9j3wANvDLly9XGe7cuQM3EIj/QmOaVAw28Pv371cYLl++XABO1T9+/P/16xdZGKQXBN6+fXuDobW1VWXy5MkxQBwBxJFk4gioGe4AXY+F+vbnt+AAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"01 1\"\n        title=\"\"\n        src=\"/static/624f90eb79890ee5f1dbf72417b73538/b9e4f/01-1.png\"\n        srcset=\"/static/624f90eb79890ee5f1dbf72417b73538/cf440/01-1.png 148w,\n/static/624f90eb79890ee5f1dbf72417b73538/d2d38/01-1.png 295w,\n/static/624f90eb79890ee5f1dbf72417b73538/b9e4f/01-1.png 590w,\n/static/624f90eb79890ee5f1dbf72417b73538/f9b6a/01-1.png 885w,\n/static/624f90eb79890ee5f1dbf72417b73538/2d849/01-1.png 1180w,\n/static/624f90eb79890ee5f1dbf72417b73538/bbefa/01-1.png 1770w,\n/static/624f90eb79890ee5f1dbf72417b73538/079dc/01-1.png 3584w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    \n<br/>\n<br/></p>\n<h2>Mediator 패턴 적용 결과 미리보기</h2>\n<p>위 코드에 Mediator 패턴을 어떤식으로 적용하는지 그 과정을 설명하기 전에 적용한 결과를 먼저 살펴보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">.\n├── Dockerfile\n├── LICENSE.md\n├── README.md\n├── frontend\n│   ├── src\n│   │   └── README\n│   └── styles\n│       └── README\n├── package-lock.json\n├── package.json\n├── pom.xml\n├── src\n│   ├── main\n│   │   ├── java\n│   │   │   └── space\n│   │   │       └── icednut\n│   │   │           └── dev\n│   │   │               └── vaadin\n│   │   │                   └── exercise\n│   │   │                       └── spring\n│   │   │                           ├── Application.java\n│   │   │                           ├── MainView.java\n│   │   │                           └── todo\n│   │   │                               ├── TodoAppParticipant.java\n│   │   │                               ├── TodoLayout.java\n│   │   │                               ├── colleage\n│   │   │                               │   ├── TodoInput.java\n│   │   │                               │   ├── TodoList.java\n│   │   │                               │   └── TodoListElement.java\n│   │   │                               ├── event\n│   │   │                               │   ├── TodoAppEvent.java\n│   │   │                               │   └── TodoAppEventListener.java\n│   │   │                               ├── exception\n│   │   │                               │   └── InvalidTodoMessageException.java\n│   │   │                               └── mediator\n│   │   │                                   ├── IMediator.java\n│   │   │                                   └── TodoMediator.java\n│   │   └── resources\n│   └── test\n│       └── java\n│           └── space\n│               └── icednut\n│                   └── dev\n│                       └── vaadin\n│                           └── exercise\n│                               └── spring\n│                                   ├── AbstractViewTest.java\n│                                   └── MainViewIT.java\n├── webpack.config.js\n└── webpack.generated.js</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">space<span class=\"token punctuation\">.</span>icednut<span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>exercise<span class=\"token punctuation\">.</span>spring</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>flow<span class=\"token punctuation\">.</span>component<span class=\"token punctuation\">.</span>orderedlayout</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">VerticalLayout</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>flow<span class=\"token punctuation\">.</span>router</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Route</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>flow<span class=\"token punctuation\">.</span>server</span><span class=\"token punctuation\">.</span>PWA<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">space<span class=\"token punctuation\">.</span>icednut<span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>exercise<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>todo</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">TodoLayout</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@Route</span>\n<span class=\"token annotation punctuation\">@PWA</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"Design Pattern Exercise\"</span><span class=\"token punctuation\">,</span> shortName <span class=\"token operator\">=</span> <span class=\"token string\">\"DPE\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MainView</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">VerticalLayout</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MainView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">TodoLayout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>일단 MainView에 직접 Todo 관련 UI 컴포넌트들을 조합하던 코드들은 TodoLayout 이라는 클래스로 몰아놨다. TodoLayout의 코드는 다음과 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">space<span class=\"token punctuation\">.</span>icednut<span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>exercise<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>todo</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>flow<span class=\"token punctuation\">.</span>component<span class=\"token punctuation\">.</span>orderedlayout</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">VerticalLayout</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">space<span class=\"token punctuation\">.</span>icednut<span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>exercise<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>todo<span class=\"token punctuation\">.</span>colleage</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">TodoInput</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">space<span class=\"token punctuation\">.</span>icednut<span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>exercise<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>todo<span class=\"token punctuation\">.</span>colleage</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">TodoList</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">space<span class=\"token punctuation\">.</span>icednut<span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>exercise<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>todo<span class=\"token punctuation\">.</span>event</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">TodoAppEventListener</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">space<span class=\"token punctuation\">.</span>icednut<span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>exercise<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>todo<span class=\"token punctuation\">.</span>mediator</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">IMediator</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">space<span class=\"token punctuation\">.</span>icednut<span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>exercise<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>todo<span class=\"token punctuation\">.</span>mediator</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">TodoMediator</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TodoLayout</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">VerticalLayout</span> <span class=\"token punctuation\">{</span>\n\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">IMediator</span> mediator <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TodoMediator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">TodoLayout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">TodoAppEventListener</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TodoAppParticipant</span><span class=\"token punctuation\">></span></span> actionListener <span class=\"token operator\">=</span> event <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">final</span> <span class=\"token class-name\">TodoAppParticipant</span> todoAppParticipant <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span><span class=\"token function\">getSource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            todoAppParticipant<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token keyword\">final</span> <span class=\"token class-name\">TodoInput</span> todoInput <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TodoInput</span><span class=\"token punctuation\">(</span>mediator<span class=\"token punctuation\">,</span> actionListener<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token keyword\">final</span> <span class=\"token class-name\">TodoList</span> todoList <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TodoList</span><span class=\"token punctuation\">(</span>mediator<span class=\"token punctuation\">,</span> actionListener<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n        <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>todoInput<span class=\"token punctuation\">,</span> todoList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>TodoLayout에는 TodoInput 컴포넌트와 TodoList 컴포넌트로 구성되어있다. TodoInput에서 Todo 내용을 입력하고 Add 버튼을 클릭하면 TodoList에 Todo 항목을 추가하는 형식으로 구현되어 있다. 그런데 TodoInput과 TodoList는 클래스로 분리되어 있는데 TodoInput은 TodoList에 항목 추가하라는 신호를 어떻게 보내는 것일까?</p>\n<p>그 역할은 바로 TodoMediator가 하게 된다. 이렇게 TodoMediator에 Todo 항목 추가라는 로직을 모아두면 Todo 항목 추가 시 TodoInput은 TodoList의 존재를 몰라도 되며, TodoInput과 TodoList는 각자 자신의 역할에만 충실할 수 있게 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">space<span class=\"token punctuation\">.</span>icednut<span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>exercise<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>todo<span class=\"token punctuation\">.</span>mediator</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">space<span class=\"token punctuation\">.</span>icednut<span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>exercise<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>todo<span class=\"token punctuation\">.</span>colleage</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">TodoInput</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">space<span class=\"token punctuation\">.</span>icednut<span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>exercise<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>todo<span class=\"token punctuation\">.</span>colleage</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">TodoList</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">space<span class=\"token punctuation\">.</span>icednut<span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>exercise<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>todo<span class=\"token punctuation\">.</span>colleage</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">TodoListElement</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">IMediator</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">void</span> <span class=\"token function\">registerTodoInput</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TodoInput</span> todoInput<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">void</span> <span class=\"token function\">registerTodoList</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TodoList</span> todoList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">void</span> <span class=\"token function\">addTodo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">void</span> <span class=\"token function\">deleteTodo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> todoId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">space<span class=\"token punctuation\">.</span>icednut<span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>exercise<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>todo<span class=\"token punctuation\">.</span>mediator</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">space<span class=\"token punctuation\">.</span>icednut<span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>exercise<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>todo</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">TodoMessage</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">space<span class=\"token punctuation\">.</span>icednut<span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>exercise<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>todo<span class=\"token punctuation\">.</span>colleage</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">TodoInput</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">space<span class=\"token punctuation\">.</span>icednut<span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>exercise<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>todo<span class=\"token punctuation\">.</span>colleage</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">TodoList</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">space<span class=\"token punctuation\">.</span>icednut<span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">.</span>vaadin<span class=\"token punctuation\">.</span>exercise<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>todo<span class=\"token punctuation\">.</span>colleage</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">TodoListElement</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/**\n * @author will.109\n * @date 31/08/2019\n **/</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TodoMediator</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">IMediator</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">TodoInput</span> todoInput<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">TodoList</span> todoList<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">registerTodoInput</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TodoInput</span> todoInput<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todoInput <span class=\"token operator\">=</span> todoInput<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">registerTodoList</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TodoList</span> todoList<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todoList <span class=\"token operator\">=</span> todoList<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">addTodo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">TodoMessage</span> todoMessage <span class=\"token operator\">=</span> todoInput<span class=\"token punctuation\">.</span><span class=\"token function\">getCurrentTodoMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        todoList<span class=\"token punctuation\">.</span><span class=\"token function\">addTodo</span><span class=\"token punctuation\">(</span>todoMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        todoInput<span class=\"token punctuation\">.</span><span class=\"token function\">clearField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">deleteTodo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> todoId<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        todoList<span class=\"token punctuation\">.</span><span class=\"token function\">getChildren</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>component <span class=\"token operator\">-></span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">TodoListElement</span><span class=\"token punctuation\">)</span> component<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>todoListElement <span class=\"token operator\">-></span> todoListElement<span class=\"token punctuation\">.</span><span class=\"token function\">getTodoId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>todoId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">findFirst</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">ifPresent</span><span class=\"token punctuation\">(</span>targetTodoListElement <span class=\"token operator\">-></span> todoList<span class=\"token punctuation\">.</span><span class=\"token function\">deleteTodo</span><span class=\"token punctuation\">(</span>targetTodoListElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","frontmatter":{"title":"Todo 앱을 통한 Mediator Pattern의 이해 (with Java, Vaadin)","date":"2019-09-01 22:06:11","tags":["java","vaadin","design pattern","mediator pattern"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2019/09/01/20190901-mediator-pattern/","previous":{"fields":{"slug":"/2019/08/16/20190816-react-input-autocomplete-issue/"},"frontmatter":{"title":"React Input에서 자동완성(Auto Complete)가 활성화 안되는 이슈 해결하기"}},"next":null}}