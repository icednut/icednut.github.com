{"data":{"site":{"siteMetadata":{"title":"Icednut's Notes","author":"Will Lee","siteUrl":"https://icednut.github.io"}},"markdownRemark":{"id":"2a4576b0-aac3-5320-975f-157446cfdfaf","excerpt":"지난번 포스트(/2019/09/01/20190901-mediator-pattern)에서 Undo, Redo 기능을 적용해야 된다고 하자. 어떻게 구현하면 될까?위 문제를 해결하려면 Undo, Redo…","html":"<p>지난번 포스트(/2019/09/01/20190901-mediator-pattern)에서 Undo, Redo 기능을 적용해야 된다고 하자. 어떻게 구현하면 될까?</p>\n<p>위 문제를 해결하려면 Undo, Redo 할 행위(추가, 삭제)를 캡슐화하여 객체 형태로 만들어서 행위 객체들을 스택에 담아놓고 Undo, Redo에 따라 push, pop을 컨트롤 하면 될거 같다는 생각이 든다.\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f7dbbbf9a20658f9ca48c2e273a98d90/04655/command-pattern-preview.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 431px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 95.35962877030163%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAABuElEQVQ4y5WU567CMAyFef8XA4kfbMoeopRR9p711WfJEXALlEhuU8c5Ocd2moqiSGww/2avsTa3keJxv9+fnJ8GccS/I6GAx+NR7XK5yPV61Q3Y7XbTb3uzfjgc5Hw+u/frcIDr9Vqm06k0m03J5XJSLpel0WhIu92WWq0m3W5XwjCUzWajYKvVSiaTifqw2WymJBzgbrdTYyEIAhmNRi6QgxaLhYs5nU4KCAlYsh/fk+T9fq+nswEGGD4z/NvtVueAWFo+SoZNvV6XbDYr+XxepZKCSqUi/X5fWRIHm69FMSawMDkwNoOhxRjg27axHAIEi0dbLpduziGWw1egWMlsbrVaUigUpFgsapX59jxPqwwobBMBWiEIxkg8b6sg9hjzFZDcwYCWGQwGatY+w+FQxuOxKiAuESBSkE01q9WqVrjT6Uiv11PZHECOf5JsPfZ41fhmDgjriSXDbj6fa/LpRQoCQxjD0Pf9f334EdBuAvcTmQCRQ8spTc96orYhgNzY1UIqsvEzx+xA4uwv8xaQBWsVrFQqSSaT0cKk02ntSUCtfeJuiAOMc8ICibAir7RL3I82bvwBrx6+TwtCixgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"command pattern preview\"\n        title=\"\"\n        src=\"/static/f7dbbbf9a20658f9ca48c2e273a98d90/04655/command-pattern-preview.png\"\n        srcset=\"/static/f7dbbbf9a20658f9ca48c2e273a98d90/cf440/command-pattern-preview.png 148w,\n/static/f7dbbbf9a20658f9ca48c2e273a98d90/d2d38/command-pattern-preview.png 295w,\n/static/f7dbbbf9a20658f9ca48c2e273a98d90/04655/command-pattern-preview.png 431w\"\n        sizes=\"(max-width: 431px) 100vw, 431px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>여기서 필요한 패턴이 Command Pattern이다. 왜냐면 행위를 캡슐화하여 실행을 할 수 있어야 하기 떄문이다. 그럼 Command Pattern에 집중하기 위해 이전 포스트에서 다뤘던 Plain Todo App에 Command Pattern을 적용하도록 하겠다.\n<br/>\n<br/></p>\n<h2>Todo App with Command Pattern</h2>\n<p>커맨드 패턴을 적용하기 위해 행위를 TodoAction 이라고 추상화 한 뒤 Todo 추가, Todo 삭제 행위를 TodoInsertAction, TodoDeleteAction 이런 식으로 구현하였다. Command Pattern의 장점은 행위 뿐만 아니라 그 행위와 관련된 상태도 캡슐화 할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Route</span>\n<span class=\"token annotation punctuation\">@PWA</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"Design Pattern Exercise Command Pattern\"</span><span class=\"token punctuation\">,</span> shortName <span class=\"token operator\">=</span> <span class=\"token string\">\"Command Pattern Exercise\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MainView</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">VerticalLayout</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">AtomicLong</span> todoIdGenerator <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AtomicLong</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">VerticalLayout</span> todosList <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">VerticalLayout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">TodoInput</span> todoInput <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TodoInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MainView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        todoInput<span class=\"token punctuation\">.</span><span class=\"token function\">addAddClickListener</span><span class=\"token punctuation\">(</span>event <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">final</span> <span class=\"token keyword\">long</span> todoId <span class=\"token operator\">=</span> todoIdGenerator<span class=\"token punctuation\">.</span><span class=\"token function\">incrementAndGet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> todoMessageBody <span class=\"token operator\">=</span> todoInput<span class=\"token punctuation\">.</span><span class=\"token function\">getTodoMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">final</span> <span class=\"token class-name\">TodoMessage</span> todoMessage <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TodoMessage</span><span class=\"token punctuation\">(</span>todoId<span class=\"token punctuation\">,</span> todoMessageBody<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">final</span> <span class=\"token class-name\">TodoAction</span> todoInsertAction <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TodoInsertAction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>\n                <span class=\"token comment\">// &lt;1></span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">hasText</span><span class=\"token punctuation\">(</span>todoMessageBody<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token keyword\">final</span> <span class=\"token class-name\">TodoListElement</span> todoListElement <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TodoListElement</span><span class=\"token punctuation\">(</span>todoMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">final</span> <span class=\"token class-name\">ComponentEventListener</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ClickEvent</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Icon</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> deleteListener <span class=\"token operator\">=</span> <span class=\"token function\">getDeleteClickListener</span><span class=\"token punctuation\">(</span>todoMessage<span class=\"token punctuation\">,</span> todoListElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                    todoListElement<span class=\"token punctuation\">.</span><span class=\"token function\">addDeleteClickListener</span><span class=\"token punctuation\">(</span>deleteListener<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    todosList<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>todoListElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">return</span> <span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">ofNullable</span><span class=\"token punctuation\">(</span>todoMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            todoInsertAction<span class=\"token punctuation\">.</span><span class=\"token function\">doIt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// &lt;2></span>\n            undoStack<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>todoInsertAction<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">HorizontalLayout</span><span class=\"token punctuation\">(</span>undoButton<span class=\"token punctuation\">,</span> redoButton<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> todoInput<span class=\"token punctuation\">,</span> todosList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","frontmatter":{"title":"Todo 앱을 통한 Command Pattern의 이해 (with Java, Vaadin)","date":"2019-09-02 12:05:58","tags":["java","vaadin","design pattern","mediator pattern"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2019/09/02/20190902-command-pattern/","previous":{"fields":{"slug":"/2019/09/01/20190901-mediator-pattern/"},"frontmatter":{"title":"Todo 앱을 통한 Mediator Pattern의 이해 (with Java, Vaadin)"}},"next":null}}