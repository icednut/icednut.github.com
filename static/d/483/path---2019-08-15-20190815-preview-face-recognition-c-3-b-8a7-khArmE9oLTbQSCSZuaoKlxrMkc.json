{"data":{"site":{"siteMetadata":{"title":"Icednut's Notes","author":"Will Lee","siteUrl":"https://icednut.github.io"}},"markdownRemark":{"id":"f00acd5c-463a-59e2-9132-1f8cf4286bea","excerpt":"아래 내용은 PyCon 2019 파이썬으로 얼굴 인식 알고리즘 구현하기 튜토리얼(https://www.pycon.kr/program/tutorial-detail?id=16…","html":"<p>아래 내용은 PyCon 2019 파이썬으로 얼굴 인식 알고리즘 구현하기 튜토리얼(<a href=\"https://www.pycon.kr/program/tutorial-detail?id=161\">https://www.pycon.kr/program/tutorial-detail?id=161</a>)을 듣고 정리한 자료 입니다.\n<br/>\n<br/>\n<br/></p>\n<h3>컴퓨터 머신의 얼굴 인식 과정</h3>\n<p>일반적으로 머신에서의 얼굴 인식 과정은 다음과 같다고 한다.</p>\n<ol>\n<li>Face Detection</li>\n<li>Processing</li>\n<li>Feature Extraction</li>\n<li>Face Matching</li>\n</ol>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/07deb2548fa697e482a9790e44222158/64ca1/03.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 85.64049586776858%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAARABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHp1eJqytCwf//EABkQAAMBAQEAAAAAAAAAAAAAAAECEgAxIf/aAAgBAQABBQKn1OSpbe29ShMnrYc//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAGxAAAQQDAAAAAAAAAAAAAAAAAAEgISIxYXH/2gAIAQEABj8CWvBKwYNEEs//xAAbEAADAAMBAQAAAAAAAAAAAAAAAREhMUEQYf/aAAgBAQABPyFze6mIOqWSLMZNwf6bzYwjVJ+XBoP/2gAMAwEAAgADAAAAEI/AAP/EABcRAAMBAAAAAAAAAAAAAAAAAAABEDH/2gAIAQMBAT8QZt//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAdEAEAAgICAwAAAAAAAAAAAAABABEhMUFhUaHB/9oACAEBAAE/ECPoBbF5SXNVVvD4iXrIAziFbsq6vUJt6B8RsQ4L133Ns1j0Cf/Z'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"03\"\n        title=\"\"\n        src=\"/static/07deb2548fa697e482a9790e44222158/c739e/03.jpg\"\n        srcset=\"/static/07deb2548fa697e482a9790e44222158/8ee9c/03.jpg 148w,\n/static/07deb2548fa697e482a9790e44222158/ebbe7/03.jpg 295w,\n/static/07deb2548fa697e482a9790e44222158/c739e/03.jpg 590w,\n/static/07deb2548fa697e482a9790e44222158/5413e/03.jpg 885w,\n/static/07deb2548fa697e482a9790e44222158/4efde/03.jpg 1180w,\n/static/07deb2548fa697e482a9790e44222158/abfc3/03.jpg 1770w,\n/static/07deb2548fa697e482a9790e44222158/64ca1/03.jpg 1936w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>얼굴 인식 과정을 코드를 보면서 진행해보자.</p>\n<h4>1. Face Detection</h4>\n<p>Face Detection이란 이미지에서 얼굴을 찾아내는 과정을 말하는데 Face Detection 알고리즘으로는 MTCNN이 성능이 좋다고 한다. MTCNN 외 Detection 알고리즘은 다음과 같다.</p>\n<p>Detection Only</p>\n<ul>\n<li>Open-CV (dnn, haar)</li>\n<li>dlib (hog, cnn)</li>\n<li>face_recognition</li>\n</ul>\n<p>Detection + Alignment</p>\n<ul>\n<li>MTCNN</li>\n</ul>\n<p>Face Detection을 코드로 구현하기 위해 Google Drive에 적당한 위치에 <code class=\"language-text\">face_detection.ipynb</code> 파일을 생성한 뒤 아래 코드들을 추가한다. ipynb 파일은 colab 앱과 연동해야 한다.</p>\n<h5>구글 드라이브와 colab 연동</h5>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\"><span class=\"token keyword\">from</span> google<span class=\"token punctuation\">.</span>colab <span class=\"token keyword\">import</span> drive\ndrive<span class=\"token punctuation\">.</span>mount<span class=\"token punctuation\">(</span><span class=\"token string\">'/colab'</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h4>3. Feature Extraction</h4>\n<p>얼굴 판별을 위해 얼굴 이미지에서 특징(Feature) 추출해야 한다. 이렇게 특정인에 대해 피처를 추출하여 벡터화 한 뒤 다른 사람과의 벡터와 거리 계산을 해보면 얼굴이 닮지 않을 수록 거리 값이 1에 가깝게 나온다. 이런 식으로 피처 추출 및 얼굴을 사람별로 분류하는 알고리즘으로는 대표적으로 FaceNet과 Arcface가 성능이 좋다고 알려져 있다.</p>\n<p>FaceNet의 특징</p>\n<ul>\n<li>Triplet Loss를 이용하여 이미지를 공간 벡터에 투영(Embadding)하여 학습</li>\n<li>128차원의 피처를 추출, 벡터에 임베딩하여 벡터의 거리를 Euclidean Distance를 이용하여 가장 가까운 거리의 데이터를 찾는 방식</li>\n<li>피처 벡터는 t-SNE 시각화 알고리즘을 통해 2차원 공간에 표시할 수 있음</li>\n</ul>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ad2bb75a433378d3d4d2c59e32c57ccb/73fa1/02.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 60.969387755102034%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIDAQX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHtLVShgf/EABkQAQADAQEAAAAAAAAAAAAAAAEAAiEQEf/aAAgBAQABBQJMqPGV08J//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGRAAAQUAAAAAAAAAAAAAAAAAAAERICKB/9oACAEBAAY/AlLNkf/EABsQAAICAwEAAAAAAAAAAAAAAAARATEhQWFx/9oACAEBAAE/IWoT1ZFdfoZSck2M4Qf/2gAMAwEAAgADAAAAED/P/8QAFhEBAQEAAAAAAAAAAAAAAAAAERAh/9oACAEDAQE/EEyf/8QAFhEAAwAAAAAAAAAAAAAAAAAAEBFB/9oACAECAQE/EIh//8QAHRABAAICAgMAAAAAAAAAAAAAAQARIUExUYGx8f/aAAgBAQABPxBigNtpQdNbiQTfQe4BLEZczMp4jY1L41PlT//Z'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"02\"\n        title=\"\"\n        src=\"/static/ad2bb75a433378d3d4d2c59e32c57ccb/c739e/02.jpg\"\n        srcset=\"/static/ad2bb75a433378d3d4d2c59e32c57ccb/8ee9c/02.jpg 148w,\n/static/ad2bb75a433378d3d4d2c59e32c57ccb/ebbe7/02.jpg 295w,\n/static/ad2bb75a433378d3d4d2c59e32c57ccb/c739e/02.jpg 590w,\n/static/ad2bb75a433378d3d4d2c59e32c57ccb/5413e/02.jpg 885w,\n/static/ad2bb75a433378d3d4d2c59e32c57ccb/4efde/02.jpg 1180w,\n/static/ad2bb75a433378d3d4d2c59e32c57ccb/abfc3/02.jpg 1770w,\n/static/ad2bb75a433378d3d4d2c59e32c57ccb/73fa1/02.jpg 2352w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<h4>4. Face Matching</h4>\n<p>FaceNet을 통해 피처 벡터 추출 및 분류 학습을 시켜 모델을 준비하면 이제는 예측을 할 차례다. 여기서는 이런 작업을 Face Matching 이라고 부른다. FaceNet으로 추출한 Feature는 SVM으로 분류 학습을 진행한다.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4133d93f78d413ed170f094d39322175/80b4e/01.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 62.686567164179095%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACSklEQVQ4y32Ty6vTQBTG+7+58D9w71JwIbh3J4Ig7gRFEBUUXHhdqChccKMoyIVKbe3tI32laZMmmUdeM0mTzzNpbx93cQcOmSQzv/nOOd80QKOqKhyONM3gOHNY1hD9fr+OyWSCfq+H4XAI3/ex31fhcHvjAqa1JlC6XbiGlBkEjxDHEc0lXNdFFJn3GFmmaD22sGMxO6AQHIyxel4UJYiDLN0vXLpLFGVez3OCcVZhvd5DL7h7hbmC7U4hFIPnixqW53tgwHzMvClCwcACOiwDAattRhvwJaCG7YyxtPs4n/Ywc2eQSUTKTW4luBTg8znV8y86Hb8GJPEh9BIwL3KIIIQKQ0glIDMGN3RJlY1UUx2pdok1RcJDLOUCqYqhdHkEM88dsKCC8NkcZcCRLF2snEn9vaQG6bUCN4ctPKzjBPxPGyIK4Sxtao46VliWm1O0Ugg5hxiMkTgemAyx4i5SKpZSmmrIIFcBWHeIjLq98j10z7sIwuBY4WHLFXkhERKSccQJKaHOp1RHTbGRm0MJQf9SyEgiSZPak8ZKO6Ax7WAwqM1rTOt63pGvzs7nePH5N96eNvHyyxk6kxWuGo1ms4lut4tWq4V2u43xaIQ4y9G3BUKp8fDNN9x88A63H5/gxr3XePrhJwKh0LNJvcoRUhONSuNhczkalmXV18qoNDEej5BkGqMF2STSuP/qFNfvPsetR+9x7c4zPDn5gSjNMZxzZLqogSsCBkGwARqYbdu7cBznKIV/owU+fm/h668OPtHTsq9O+T/3HNmIPWA4hgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"01\"\n        title=\"\"\n        src=\"/static/4133d93f78d413ed170f094d39322175/b9e4f/01.png\"\n        srcset=\"/static/4133d93f78d413ed170f094d39322175/cf440/01.png 148w,\n/static/4133d93f78d413ed170f094d39322175/d2d38/01.png 295w,\n/static/4133d93f78d413ed170f094d39322175/b9e4f/01.png 590w,\n/static/4133d93f78d413ed170f094d39322175/f9b6a/01.png 885w,\n/static/4133d93f78d413ed170f094d39322175/2d849/01.png 1180w,\n/static/4133d93f78d413ed170f094d39322175/bbefa/01.png 1770w,\n/static/4133d93f78d413ed170f094d39322175/80b4e/01.png 2144w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>","frontmatter":{"title":"얼굴 인식 살짝 맛보기 (FaceNet, SVM, MTCNN)","date":"2019-08-15 22:26:58","tags":["python","Deep Learning","FaceNet","SVM","MTCNN","iCrawler"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2019/08/15/20190815-preview-face-recognition/","previous":{"fields":{"slug":"/2019/07/09/20190709-java-hbase-logback-slf4j/"},"frontmatter":{"title":"Java Hbase-client 디펜던시 추가 후 로그가 제대로 안나오는 이슈 (with Slf4j, Logback)"}},"next":{"fields":{"slug":"/2019/08/16/20190816-react-input-autocomplete-issue/"},"frontmatter":{"title":"React Input에서 자동완성(Auto Complete)가 활성화 안되는 이슈 해결하기"}}}}