{"data":{"site":{"siteMetadata":{"title":"Icednut's Notes","author":"Will Lee","siteUrl":"https://icednut.github.io"}},"markdownRemark":{"id":"00e628b2-3510-5144-bbb5-2ce7fd3bdf3f","excerpt":"요구사항 추가현재 Todo List 상태를 저장한 뒤에 나중에 필요할 때 복원하고 싶다. 저장 및 복원은 어떻게 구현할까?이럴 때 필요한게 Memento 패턴이다.\n\nTodo App with Memento PatternMemento…","html":"<h2>요구사항 추가</h2>\n<p>현재 Todo List 상태를 저장한 뒤에 나중에 필요할 때 복원하고 싶다. 저장 및 복원은 어떻게 구현할까?</p>\n<p>이럴 때 필요한게 Memento 패턴이다.\n<br/>\n<br/></p>\n<h2>Todo App with Memento Pattern</h2>\n<p>Memento 패턴에 집중하기 위해 다른 패턴들은 잠시 다 걷어내고 이전 포스트에서 봤던 Plain Todo App에 Todo 목록 저장, 복원 기능을 Memento 패턴을 이용하여 구현해보도록 하자.</p>\n<p>우선 Plain Todo App의 코드는 다음과 같다. (이전 포스트에서 봤던 Plain Todo App과 동일한 코드임)</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Route</span>\n<span class=\"token annotation punctuation\">@PWA</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"Plain Todo App\"</span><span class=\"token punctuation\">,</span> shortName <span class=\"token operator\">=</span> <span class=\"token string\">\"PTA\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MainView</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">VerticalLayout</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">final</span> <span class=\"token class-name\">VerticalLayout</span> todosList <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">VerticalLayout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">final</span> <span class=\"token class-name\">TextField</span> todoField <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TextField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">final</span> <span class=\"token class-name\">Button</span> addButton <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Button</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Add\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MainView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        addButton<span class=\"token punctuation\">.</span><span class=\"token function\">addClickListener</span><span class=\"token punctuation\">(</span>event <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> todoMessage <span class=\"token operator\">=</span> todoField<span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">hasText</span><span class=\"token punctuation\">(</span>todoMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">final</span> <span class=\"token class-name\">TodoListElement</span> todoListElement <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TodoListElement</span><span class=\"token punctuation\">(</span>todoMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                todoListElement<span class=\"token punctuation\">.</span><span class=\"token function\">addDeleteClickListener</span><span class=\"token punctuation\">(</span>deleteClickEvent <span class=\"token operator\">-></span> todosList<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>todoListElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                todosList<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>todoListElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                todoField<span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">HorizontalLayout</span><span class=\"token punctuation\">(</span>todoField<span class=\"token punctuation\">,</span> addButton<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> todosList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>실행 화면과 소스코드는 다음과 같다.\n\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 63.56026785714285%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAABEUlEQVQ4y2OQlpG3VVbTnK1naDJZRV1ziqS03BQRUckpImLEYQkpuSkS0nKTJWUUZgHZVQyTpkwt3bP/4P+tO3b937J99/8t23b837ptO9F49979/3ft2ff/yPGT/1euXvOY4dmzZ7n/IeAHEP8C4t9k4J9QMy4x3LhxI+/n7z//P33+/AcI/gHx/98kYKj6PyDTPn36dJXh1q1beSDO79+/QYL/gOA/DBMLgGrBBn79+hVhIBD8+UeKKcQaSKrr6O9Cahr4+x/5AGzgly9frjLcuXMHbiAQ/wVZSAYGG/j9+/crDJcvXy4Ap+ofP/7/+vWLLAzSCwJv3769wdDa2qoyefLkGCCOAOJIMnEE1Ax3APpahduIRdCDAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"plain todo app\"\n        title=\"\"\n        src=\"/static/32a3474d485e5a42418b60bd28f2d391/b9e4f/plain_todo_app.png\"\n        srcset=\"/static/32a3474d485e5a42418b60bd28f2d391/cf440/plain_todo_app.png 148w,\n/static/32a3474d485e5a42418b60bd28f2d391/d2d38/plain_todo_app.png 295w,\n/static/32a3474d485e5a42418b60bd28f2d391/b9e4f/plain_todo_app.png 590w,\n/static/32a3474d485e5a42418b60bd28f2d391/f9b6a/plain_todo_app.png 885w,\n/static/32a3474d485e5a42418b60bd28f2d391/2d849/plain_todo_app.png 1180w,\n/static/32a3474d485e5a42418b60bd28f2d391/bbefa/plain_todo_app.png 1770w,\n/static/32a3474d485e5a42418b60bd28f2d391/079dc/plain_todo_app.png 3584w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  </p>\n<p style=\"text-align: center;\">\n    <a href=\"https://github.com/icednut/vaadin-todo-app.git\" target=\"_blank\">https://github.com/icednut/vaadin-todo-app.git</a>\n</p>\n<p>그럼 요구사항을 구현하기 위해 상태 저장 및 복원 버튼인 saveButton, restoreButton을 생성한다.\n그 다음 Todo 목록 현황 즉 상태를 저장할 클래스가 필요하다. 가장 마지막 상태 관리하는 클래스를 Originator라고 하자. (Memento 패턴에서는 상태 관리하는 클래스를 Originator라고 부른다. 패턴 공부를 위해 여기서는 용어를 통일하자.) MainView는 여기서 Caretaker가 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Route</span>\n<span class=\"token annotation punctuation\">@PWA</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"Design Pattern Exercise Memento Pattern\"</span><span class=\"token punctuation\">,</span> shortName <span class=\"token operator\">=</span> <span class=\"token string\">\"Memento Pattern Exercise\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MainView</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">VerticalLayout</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">final</span> <span class=\"token class-name\">VerticalLayout</span> todosList <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">VerticalLayout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">final</span> <span class=\"token class-name\">TextField</span> todoField <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TextField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">final</span> <span class=\"token class-name\">Button</span> addButton <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Button</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Add\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">final</span> <span class=\"token class-name\">Button</span> saveButton <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Button</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Save\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">final</span> <span class=\"token class-name\">Button</span> restoreButton <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Button</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Restore\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">final</span> <span class=\"token class-name\">Originator</span> originator <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Originator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>// &lt;1></span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">final</span> <span class=\"token class-name\">LinkedList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Memento</span><span class=\"token punctuation\">></span></span> savedStates <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LinkedList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>&lt;4></span></span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MainView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        saveButton<span class=\"token punctuation\">.</span><span class=\"token function\">addClickListener</span><span class=\"token punctuation\">(</span>event <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">            savedStates<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>originator<span class=\"token punctuation\">.</span><span class=\"token function\">saveToMemento</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>// &lt;4></span></span>        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        restoreButton<span class=\"token punctuation\">.</span><span class=\"token function\">addClickListener</span><span class=\"token punctuation\">(</span>event <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">            originator<span class=\"token punctuation\">.</span><span class=\"token function\">restoreFromMemento</span><span class=\"token punctuation\">(</span>savedStates<span class=\"token punctuation\">.</span><span class=\"token function\">getLast</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>// &lt;5></span></span>        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        addButton<span class=\"token punctuation\">.</span><span class=\"token function\">addClickListener</span><span class=\"token punctuation\">(</span>event <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> todoMessage <span class=\"token operator\">=</span> todoField<span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">hasText</span><span class=\"token punctuation\">(</span>todoMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">                originator<span class=\"token punctuation\">.</span><span class=\"token function\">addState</span><span class=\"token punctuation\">(</span>todoMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>// &lt;3></span></span>\n                <span class=\"token keyword\">final</span> <span class=\"token class-name\">TodoListElement</span> todoListElement <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TodoListElement</span><span class=\"token punctuation\">(</span>todoMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                todoListElement<span class=\"token punctuation\">.</span><span class=\"token function\">addDeleteClickListener</span><span class=\"token punctuation\">(</span>deleteClickEvent <span class=\"token operator\">-></span> todosList<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>todoListElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                todosList<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>todoListElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                todoField<span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token function\">controlComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> todosList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">HorizontalLayout</span> <span class=\"token function\">controlComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>&#x3C;1> : originator에서 가장 마지막에 저장된 상태를 가지고 있다. 여기서 상태는 Todo Message 목록을 말한다.</li>\n<li>&#x3C;3> : 새로 추가한 Todo Message는 Originator에서 관리되고 있는 Todo Message 목록(상태)에 추가한다. 이로써 Originator는 가장 최근 상태를 항상 유지하게 된다.</li>\n<li>&#x3C;4> : 저장 버튼을 클릭하면 originator에 가장 최근 상태의 Todo Message 목록을 박제한다. 여기서 박제한다는 표현은 Originator에서 최근 Todo Message 목록을 가져와서 Caretaker 역할을 하는 MainView에 저장한다는 뜻이다.</li>\n<li>&#x3C;5> : 복원 버튼을 누르면 MainView에서 들고 있는 가장 마지막에 저장된 Todo Message 목록을 복원한다.</li>\n</ul>\n<p>Originator 클래스와 Memento 클래스는 다음과 같다. 여기서 Memento 클래스는 상태를 한 번 감싼 클래스를 말한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Originator</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> todoMessageListState <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">addState</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> todoMessage<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todoMessageListState<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>todoMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Memento</span> <span class=\"token function\">saveToMemento</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Memento</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>todoMessageListState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">restoreFromMemento</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Memento</span> memento<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todoMessageListState <span class=\"token operator\">=</span> memento<span class=\"token punctuation\">.</span><span class=\"token function\">getSavedMemento</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> <span class=\"token function\">totoMessageListString</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> todoMessageListState<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> todoMessageListState<span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">collect</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collectors</span><span class=\"token punctuation\">.</span><span class=\"token function\">joining</span><span class=\"token punctuation\">(</span><span class=\"token string\">\",\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Memento</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> todoMessageListState<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Memento</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> todoMessageListState<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todoMessageListState <span class=\"token operator\">=</span> todoMessageListState<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">getSavedMemento</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> todoMessageListState<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>여기까지만 하면 Todo Meesage 목록 저장 및 복원을 볼 수 있다. 하지만 복원된 Todo Message는 화면에 뿌리질 않았으니 복원 버튼을 눌러도 화면 변화가 없다. 복원한 Todo Message를 화면에 다시 그리기 위해서 Renderer 클래스를 구현해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Route</span>\n<span class=\"token annotation punctuation\">@PWA</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"Design Pattern Exercise Memento Pattern\"</span><span class=\"token punctuation\">,</span> shortName <span class=\"token operator\">=</span> <span class=\"token string\">\"Memento Pattern Exercise\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MainView</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">VerticalLayout</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">final</span> <span class=\"token class-name\">VerticalLayout</span> todosList <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">VerticalLayout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">final</span> <span class=\"token class-name\">TextField</span> todoField <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TextField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">final</span> <span class=\"token class-name\">Button</span> addButton <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Button</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Add\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">final</span> <span class=\"token class-name\">Button</span> saveButton <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Button</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Save\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">final</span> <span class=\"token class-name\">Button</span> restoreButton <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Button</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Restore\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// &lt;1></span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">final</span> <span class=\"token class-name\">TodoRestoreRenderer</span> todoRestoreRenderer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TodoRestoreRenderer</span><span class=\"token punctuation\">(</span>restoredTodoMessageList <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">CollectionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isEmpty</span><span class=\"token punctuation\">(</span>restoredTodoMessageList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">            <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\">        todosList<span class=\"token punctuation\">.</span><span class=\"token function\">removeAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">        restoredTodoMessageList<span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\">                <span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>restoredTodoMessage <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">                    <span class=\"token keyword\">final</span> <span class=\"token class-name\">TodoListElement</span> todoListElement <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TodoListElement</span><span class=\"token punctuation\">(</span>restoredTodoMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">                    todoListElement<span class=\"token punctuation\">.</span><span class=\"token function\">addDeleteClickListener</span><span class=\"token punctuation\">(</span>deleteClickEvent <span class=\"token operator\">-></span> todosList<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>todoListElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">                    todosList<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>todoListElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n    <span class=\"token comment\">// &lt;2></span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">final</span> <span class=\"token class-name\">Originator</span> originator <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Originator</span><span class=\"token punctuation\">(</span>todoRestoreRenderer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token keyword\">final</span> <span class=\"token class-name\">LinkedList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Memento</span><span class=\"token punctuation\">></span></span> savedStates <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LinkedList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MainView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        saveButton<span class=\"token punctuation\">.</span><span class=\"token function\">addClickListener</span><span class=\"token punctuation\">(</span>event <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>\n            savedStates<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>originator<span class=\"token punctuation\">.</span><span class=\"token function\">saveToMemento</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        restoreButton<span class=\"token punctuation\">.</span><span class=\"token function\">addClickListener</span><span class=\"token punctuation\">(</span>event <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>\n            originator<span class=\"token punctuation\">.</span><span class=\"token function\">restoreFromMemento</span><span class=\"token punctuation\">(</span>savedStates<span class=\"token punctuation\">.</span><span class=\"token function\">getLast</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        addButton<span class=\"token punctuation\">.</span><span class=\"token function\">addClickListener</span><span class=\"token punctuation\">(</span>event <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> todoMessage <span class=\"token operator\">=</span> todoField<span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">hasText</span><span class=\"token punctuation\">(</span>todoMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                originator<span class=\"token punctuation\">.</span><span class=\"token function\">addState</span><span class=\"token punctuation\">(</span>todoMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token keyword\">final</span> <span class=\"token class-name\">TodoListElement</span> todoListElement <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TodoListElement</span><span class=\"token punctuation\">(</span>todoMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                todoListElement<span class=\"token punctuation\">.</span><span class=\"token function\">addDeleteClickListener</span><span class=\"token punctuation\">(</span>deleteClickEvent <span class=\"token operator\">-></span> todosList<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>todoListElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                todosList<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>todoListElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                todoField<span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token function\">controlComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> todosList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">HorizontalLayout</span> <span class=\"token function\">controlComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">TodoRestoreRenderer</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Consumer</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">List</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> renderProcessor<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">TodoRestoreRenderer</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Consumer</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">List</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> renderProcessor<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>renderProcessor <span class=\"token operator\">=</span> renderProcessor<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> todoMessageListState<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        renderProcessor<span class=\"token punctuation\">.</span><span class=\"token function\">accept</span><span class=\"token punctuation\">(</span>todoMessageListState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Originator</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">TodoRestoreRenderer</span> todoRestoreRenderer<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> todoMessageListState <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Originator</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TodoRestoreRenderer</span> todoRestoreRenderer<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todoRestoreRenderer <span class=\"token operator\">=</span> todoRestoreRenderer<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">addState</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> todoMessage<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todoMessageListState<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>todoMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Memento</span> <span class=\"token function\">saveToMemento</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Memento</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>todoMessageListState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">restoreFromMemento</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Memento</span> memento<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todoMessageListState <span class=\"token operator\">=</span> memento<span class=\"token punctuation\">.</span><span class=\"token function\">getSavedMemento</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">        todoRestoreRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>todoMessageListState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>// &lt;3></span></span>    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> <span class=\"token function\">totoMessageListString</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> todoMessageListState<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> todoMessageListState<span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">collect</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collectors</span><span class=\"token punctuation\">.</span><span class=\"token function\">joining</span><span class=\"token punctuation\">(</span><span class=\"token string\">\",\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>&#x3C;1> : 복원 요청을 받았을 때 처리할 렌더러 객체를 생성한다. 복원 로직은 함수로 선언하며 복원할 Todo Message 목록을 가지고 컴포넌트를 화면에 구성하는 작업을 진행한다.</li>\n<li>&#x3C;2> : originator의 생성자로 렌더러 객체를 받고 있는데 이는 originator 내부에서 restore 시 사용하게 된다.</li>\n<li>&#x3C;3> : 전에 봤던 originator와 달라진 부분. originator.restoreFromMemento 메소드 호출 시 렌더러 객체에 복원된 목록을 화면에 출력하라는 요청도 보내게 된다.</li>\n</ul>\n<p>여기까지 구현한 결과 실행화면과 소스코드는 다음과 같다.\n\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 63.56026785714285%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAABMklEQVQ4y72Sv0rDQBzH7yGkNmlohYp/FkFwdfYVKvgKBhcX97xAExd9ArFg0SaRtloEQVyNgSRkE7JlSRMSczE/L+lVXGLpDX7hw/3ud7/73HKoIbT22xtblzu7e3J7c1vhhZZSW+UIvLJS4xZS55tKvdGUOWHtgtRnqKucn44nT6DeDwkj6N9p0OsP4OZWA1XXYaDpoP7B6GECw/EjPL+8wtV17wN5nncMsySElIAZ+KSON2RZlpjiDILpNCPJCTAH/1qroOdZYQuCwES2bYvFBuOymZPAHJg1gJaVITOlMIoiEzmOI9J+llNLvsiwjHBZ2f8LgSFVQpyzpxSGYWgi13V/hISv4kEGSmEcx+/IMIyT8lcnCaRpykRxt4jv+xaSJGldluUjQodwyEiHOg6+AYuZhboIIEfHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"memento pattern result 01\"\n        title=\"\"\n        src=\"/static/03c1ca121cf9d8a4f271dad5d50be06a/b9e4f/memento-pattern-result-01.png\"\n        srcset=\"/static/03c1ca121cf9d8a4f271dad5d50be06a/cf440/memento-pattern-result-01.png 148w,\n/static/03c1ca121cf9d8a4f271dad5d50be06a/d2d38/memento-pattern-result-01.png 295w,\n/static/03c1ca121cf9d8a4f271dad5d50be06a/b9e4f/memento-pattern-result-01.png 590w,\n/static/03c1ca121cf9d8a4f271dad5d50be06a/f9b6a/memento-pattern-result-01.png 885w,\n/static/03c1ca121cf9d8a4f271dad5d50be06a/2d849/memento-pattern-result-01.png 1180w,\n/static/03c1ca121cf9d8a4f271dad5d50be06a/bbefa/memento-pattern-result-01.png 1770w,\n/static/03c1ca121cf9d8a4f271dad5d50be06a/079dc/memento-pattern-result-01.png 3584w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 63.56026785714285%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAABHklEQVQ4y9WSv0rDQByA7yGkNmlohYraRRBcnX2FCr6CxcXFPS/Qi0t9ArFg0fwpbbUIgrgaCyFkE7JlCQmJuZifd0kqDhrxNj/4uB/c3XfLoYbU2mtvbJ1v7+zi9mZHEaWWUlsVqKKyUhN+tS42lXqjiQVpbUDnU9RXzk5m83vQxhNQx1MY3egwHKlwda2DZhig6gZoFU5v5zCZ3cHD4xNcXA5fkeu6R1AQUxMq4fCtbDwjy7J6bCKEpJSMCkvJl/Uny/2UNXzfXyDbtntlPc0KYCmjmKESeiYPhmH4ffCvVAaBg/8bJBk/eTAIggVyHOczSH1nD3KYB6MoekGmaR7nvzqOIUkSLtldhud5FpJleR1jfEjtUg847ZaN/Q8mpYXvHvB9dAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"memento pattern result 02\"\n        title=\"\"\n        src=\"/static/3031da2e39fb7070795613606ffd7fd8/b9e4f/memento-pattern-result-02.png\"\n        srcset=\"/static/3031da2e39fb7070795613606ffd7fd8/cf440/memento-pattern-result-02.png 148w,\n/static/3031da2e39fb7070795613606ffd7fd8/d2d38/memento-pattern-result-02.png 295w,\n/static/3031da2e39fb7070795613606ffd7fd8/b9e4f/memento-pattern-result-02.png 590w,\n/static/3031da2e39fb7070795613606ffd7fd8/f9b6a/memento-pattern-result-02.png 885w,\n/static/3031da2e39fb7070795613606ffd7fd8/2d849/memento-pattern-result-02.png 1180w,\n/static/3031da2e39fb7070795613606ffd7fd8/bbefa/memento-pattern-result-02.png 1770w,\n/static/3031da2e39fb7070795613606ffd7fd8/079dc/memento-pattern-result-02.png 3584w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 63.56026785714285%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAABM0lEQVQ4y72Sv0rDQBzH7yGkNmlohYraRRBcnX2FCr6CwcXFPS9g4lKfwH+omCalrRZBEFdjIAnZhGxZ0oTEXMzPS3p1a0tv8Asf7ne/+93nlkM1obHX3Ni62N7ZlZubLYUXGkpllSPwykqFW0iVryvVWl3mhLUOqU/RmXJ+Mhy9QLfXB7U3gPtHDa7uVLh90EDTdVA1HbpzGDyNoD98hte3d7i8vvlCnucdwSQJISVgBr6p4wNZliWmOINgPM5IcgJMwZiuc6DnWWELgsBEtm2LxQbjspmTwBSYNICWM0NmSmEURSZyHEek/SynlnyRYRnhsrL/FwJDZglxzp5SGIahiVzX/RMSfooHGSiFcRx/IsMwjstfnSSQpikTxd0ivu9bSJKkdVmWDwltwgEjberY/wVyQYWz5LmRPQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"memento pattern result 03\"\n        title=\"\"\n        src=\"/static/04bfa90767a7017a0d0ee029aabacb86/b9e4f/memento-pattern-result-03.png\"\n        srcset=\"/static/04bfa90767a7017a0d0ee029aabacb86/cf440/memento-pattern-result-03.png 148w,\n/static/04bfa90767a7017a0d0ee029aabacb86/d2d38/memento-pattern-result-03.png 295w,\n/static/04bfa90767a7017a0d0ee029aabacb86/b9e4f/memento-pattern-result-03.png 590w,\n/static/04bfa90767a7017a0d0ee029aabacb86/f9b6a/memento-pattern-result-03.png 885w,\n/static/04bfa90767a7017a0d0ee029aabacb86/2d849/memento-pattern-result-03.png 1180w,\n/static/04bfa90767a7017a0d0ee029aabacb86/bbefa/memento-pattern-result-03.png 1770w,\n/static/04bfa90767a7017a0d0ee029aabacb86/079dc/memento-pattern-result-03.png 3584w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  </p>\n<p style=\"text-align: center;\"><a href=\"https://github.com/icednut/vaadin-todo-app/tree/step-4-memento-pattern-without-command-pattern\" target=\"_blank\">https://github.com/icednut/vaadin-todo-app/tree/step-4-memento-pattern-without-command-pattern</a></p>\n<br/>\n<br/>\n<hr>\n<h2>Memento 패턴과 Command 패턴을 결합한 Undo, Redo 기능 구현</h2>\n<p>잠시 Undo, Redo 구현을 떠나서 만약에 3 * 3 연산을 하면 뭐가 나올까? 9가 나온다. 하지만 9를 다시 곱하기 연산 이전으로 되돌리면 뭐가 될까? 3이 될 수도 있고 -3이 될 수도 있다(9의 제곱근을 생각해보길). 이렇게 9 이전의 상태가 2개가 나올 수 있기 때문에 뭘로 복원해야 될지를 모르게 된다.\n다시 생각해보면 9를 이전으로 되돌리기 위해서는 이전에 어떠했는지에 대한 상태를 저장해야 한다. 이렇게 상태를 저장하는 로직을 구현할 때 필요한게 바로 Memento 패턴이다.</p>\n<p>텍스트 에디터나 IDE의 Undo, Redo 기능을 보면 이렇게 상태를 캡쳐하여 저장한 뒤 Undo, Redo 이벤트가 발생하면 해당 상태를 복원하는 식으로 구현이 되어 있다고 한다. 그래서 메모리에 상태를 저장하는데 한계가 있으므로 Undo, Redo 횟수가 제한되어 있는 경우가 많다.</p>\n<p>시간 관계 상 이 부분은 추후 완료할 예정\n<br/>\n<br/></p>\n<hr>\n<h2>Memento Pattern 정리</h2>\n<h3>특징</h3>\n<ul>\n<li>외부 엔터티도 객체의 구조를 알 수 없는 방식으로 객체의 상태를 캡슐화한다. Caretaker라 불리는 외부 객체는 객체의 무결성을 위반하지 않으면서도 객체의 상태를 저장하거나 복구할 수 있다.</li>\n</ul>\n<h3>어떤 문제를 해결하는가?</h3>\n<ul>\n<li>트랜잭션 처리 구현 시 트랜잭션 단위를 커맨드 클래스로 정의</li>\n<li>Undo 기능 구현</li>\n<li>멀티 스레드에서 콜백을 감싸는 Thread가 대표적인 커맨트 패턴 사용 예</li>\n</ul>\n<h3>구조</h3>\n<p><img src=\"command-pattern-diagram.png\"></p>\n<h3>참여자</h3>\n<ul>\n<li>Command</li>\n<li>Concrete Command</li>\n<li>Invoker</li>\n<li>Receiver</li>\n</ul>","frontmatter":{"title":"Todo 앱을 통한 Memento Pattern의 이해 (with Java, Vaadin)","date":"2019-09-03 06:55:28","tags":["java","vaadin","design pattern","memento pattern"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2019/09/03/20190903-memento-pattern/","previous":{"fields":{"slug":"/2019/09/02/20190902-command-pattern/"},"frontmatter":{"title":"Todo 앱을 통한 Command Pattern의 이해 (with Java, Vaadin)"}},"next":null}}